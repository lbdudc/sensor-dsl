CREATE PRODUCT intecmar USING 4326;

CREATE SPATIAL DIMENSION Municipality (
	geometry: Polygon
) WITH PROPERTIES (
	cMun Integer DISPLAY_STRING
);

CREATE SPATIAL DIMENSION District (
	geometry: Polygon
) WITH PROPERTIES (
	cDis Integer DISPLAY_STRING
) WITH PARENT (
	Municipality 
);

CREATE SPATIAL DIMENSION Section (
	geometry: Polygon
) WITH PROPERTIES (
	cSec Integer DISPLAY_STRING
) WITH PARENT (
	District 
);

CREATE SPATIAL DIMENSION Barrio (
	geometry: Polygon
) WITH PROPERTIES (
	cBarrio Integer DISPLAY_STRING
);

CREATE RANGE DepthRange (
  0 TO 3 AS "surface",
  4.75 TO 5.25 AS "5m",
  9.75 TO 10.25 AS "10m",
  19.75 TO 20.25 AS "20m"
);

CREATE RANGE TempRange (
  -Infinity TO 0 AS "frio" COLOR #0000FF,
  10 TO 20 AS "templado" COLOR #00FF00,
  20 TO Infinity AS "caliente" COLOR #FF0000,
  DEFAULT AS "desconocido" COLOR #FFFFFF
);

CREATE RANGE SexoRange (
  hombre AS "hombre" COLOR #0000FF,
  mujer AS "mujer" COLOR #FF0000
);

CREATE CATEGORICAL DIMENSION DepthDimension (
  field: depth
);

CREATE CATEGORICAL DIMENSION SexoDimension (
  field: sex
);

CREATE SENSOR StationObservation (
  interval: 500,
  datasource: elasticsearch,
  geometry: Point
) WITH PROPERTIES (
  maxDepth Float,
  code String,
  name String,
  description String,
  startTime Datetime,
  endTime Datetime
) WITH MEASUREMENT DATA (
  temperature_ITS90 Double UNITS "ÂºC" ICON "thermometer-low" RANGE TempRange,
  salinity Double UNITS "PSU",
  pressure Double UNITS "dbar" ICON "speedometer",
  ph Double UNITS "pH" ICON "ph",
  oxygen Double UNITS "mg/l" ICON "gas-cylinder",
  transmittance Double UNITS "m",
  irradiance Double UNITS "W/m2",
  uv_flourescence Double UNITS "mg/m3",
  density Double UNITS "kg/m3",
  depth Double UNITS "m",
  conductivity Double UNITS "S/m"
) WITH SPATIAL DIMENSIONS Administrative (
  Municipality,
  District,
  Section
) WITH SPATIAL DIMENSIONS Barrio (
  Barrio
) WITH CATEGORICAL DIMENSIONS (
  DepthDimension RANGE DepthRange,
  SexoDimension RANGE SexoRange,
  SexoDimension
);
